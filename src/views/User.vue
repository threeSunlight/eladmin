<template>
<h1>{{ useInfo.name }}</h1>
<h1>{{ useInfo.age }}</h1>
<h1>æ‹¼æ¥çš„æ–°æ•°æ®:{{ useInfo.newNameAndAge }}</h1>
<button @click="updatePiniaState">ä¿®æ”¹åå­—</button>
<button @click="handlerGetuser">è¯·æ±‚æ¥å£</button>
<!-- piniaä¸­çš„åŸºæœ¬APIæ–¹æ³• -->
<el-button type="button" @click="reset">é‡ç½®</el-button>
</template>

<script lang="ts" setup>
/**
 * ç¬¬ä¸€æ­¥: å…ˆéœ€è¦å¼•å…¥
 */
import {useInfoStore} from  '../stores'
  // å¯¼å…¥storeToRefs
  import { storeToRefs } from 'pinia'
/**
 * ç¬¬äºŒæ­¥: å£°æ˜è°ƒç”¨å‡½æ•°
 */
const useInfo = useInfoStore()
console.log("***************");
console.log(useInfo);
console.log("***************");

// piniaçš„è§£æ„,è§£æ„å‡ºæ¥çš„æ•°æ®æ˜¯éå“åº”å¼æ˜¯æ•°æ®,ä¸èƒ½ç›´æ¥è¿›è¡Œä¿®æ”¹
// let {name,age} = storeToRefs(useInfo)
// console.log('/////////////////');
// // 
// console.log(name,age);
// console.log('/////////////////');

/**ç¬¬ä¸€ç§: åœ¨é¡µé¢ä¸­ç›´æ¥ä¿®æ”¹piniaä¸­çš„stateå€¼ */
// const updatePiniaState = () => {
//     useInfo.name = "å¾ä¿Šè‰¯"
//     useInfo.age = 33
// }

/**
 * éœ€æ±‚: éœ€è¦å…ˆåˆ¤æ–­flagå‚æ•°æ˜¯å¦ä¸ºtrue,å¦‚æœä¸ºtrueæ‰èƒ½ä¿®æ”¹
 */

/**ç¬¬äºŒç§: é€šè¿‡$patchå‡½æ•°ç›´æ¥ä¿®æ”¹stateä¸­çš„å€¼ */
// const updatePiniaState = () => {
//     useInfo.$patch({
//         name: 'å¾ä¿Šè‰¯',
//         age: 40
//     })
// }

/**ç¬¬ä¸‰ç§: é€šè¿‡$patchå‡½æ•°ç›´æ¥ä¿®æ”¹stateä¸­çš„å€¼,ä½†æ˜¯ä¼ å‚å˜æˆäº†ä¸€ä¸ªå‡½æ•°--æ¨è */
// const updatePiniaState = () => {
//     useInfo.$patch((state) => {
//         state.flag = true
//         if(state.flag) {
//             state.name = 'å¾ä¿Šè‰¯',
//             state.age = 40
//         }
//     })
// }

/**ç¬¬å››ç§: é€šè¿‡$stateçš„æ–¹å¼ä¿®æ”¹,å¼Šç«¯ç›´æ¥æ›¿æ¢æ‰stateæ•°æ®---æœ€ä¸æ¨èçš„å†™æ³• */
// const updatePiniaState = () => {
//     useInfo.$state = {
//       name: 'ğ’†ğ’….',
//       age: 11,
//       flag: true
//     }
// }


/**ç¬¬äº”ç§: é€šè¿‡actionsæ¥ä¿®æ”¹stateä¸­çš„æ•°æ® */
const updatePiniaState = () => {
    useInfo.update()
}

// /**ç¬¬å…­ç§: éå“åº”å¼æ•°æ®è¿›è¡Œä¿®æ”¹ */
// const updatePiniaState = () => {
//     age++
// }
const handlerGetuser = () => {
    useInfo.getUser()
}

/**é‡ç½®piniaåˆå§‹å€¼ */
const reset = () => { 
  useInfo.$reset()
}

/**ç›‘å¬stateä¸­æ•°æ®å˜åŒ– 
 * args :é‡Œé¢åŒ…å«äº†,å½“å‰çš„ä¿®æ”¹æ•°æ®çš„æ–°æ—§valueå€¼
 * state: æˆ‘ä»¬æ•´ä¸ªå£°æ˜çš„stateæ•°æ®å˜åŒ–
 * 
 * 
*/
 // ç›‘å¬ state çš„å˜åŒ–ï¼Œè¿”å›ä¸€ä¸ªå·¥å‚å‡½æ•°
 useInfo.$subscribe((args, state) => {
  console.log("***************");
    console.log(args, state)
    console.log("***************");
  })

/**ç›‘å¬actionsæ˜¯å¦ä¼šè¢«è°ƒç”¨
 * è¿›è¡Œæ¥å£ä¿®æ”¹å’Œæ•°æ®å˜åŒ–
 */
useInfo.$onAction(args => {

  console.log('****-----------------');
  console.log(args);
  console.log('****-----------------');
})
</script>
<style>
</style>